<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Data Cleaning | Uncovering Data Science with R</title>
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Chapter 3 Data Cleaning | Uncovering Data Science with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://uncovering-data-science.netlify.app/data-cleaning.html">
<meta property="og:image" content="https://uncovering-data-science.netlify.app/images/cover.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Data Cleaning | Uncovering Data Science with R">
<meta name="twitter:image" content="https://uncovering-data-science.netlify.app/images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="The quality of input data has a huge impact on the Data Science Methodology. For data analytics purposes, database values must undergo data cleaning and data transformation. Basically, we want to...">
<meta property="og:description" content="The quality of input data has a huge impact on the Data Science Methodology. For data analytics purposes, database values must undergo data cleaning and data transformation. Basically, we want to...">
<meta name="twitter:description" content="The quality of input data has a huge impact on the Data Science Methodology. For data analytics purposes, database values must undergo data cleaning and data transformation. Basically, we want to...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Uncovering Data Science with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="the-basics-for-r.html"><span class="header-section-number">1</span> The Basics for R</a></li>
<li><a class="" href="intro-DS.html"><span class="header-section-number">2</span> Introduction to Data Science</a></li>
<li><a class="active" href="data-cleaning.html"><span class="header-section-number">3</span> Data Cleaning</a></li>
<li><a class="" href="exploratory-data-analysis-1.html"><span class="header-section-number">4</span> Exploratory Data Analysis</a></li>
<li><a class="" href="statistical-inference-and-hypothesis-testing.html"><span class="header-section-number">5</span> Statistical Inference and Hypothesis Testing</a></li>
<li><a class="" href="modeling-process.html"><span class="header-section-number">6</span> Modeling Process</a></li>
<li><a class="" href="k-nearest-neighbors.html"><span class="header-section-number">7</span> K-Nearest Neighbors</a></li>
<li><a class="" href="model-evaluation.html"><span class="header-section-number">8</span> Model Evaluation</a></li>
<li><a class="" href="naive-bayes-classifier.html"><span class="header-section-number">9</span> Naive Bayes Classifier</a></li>
<li><a class="" href="regression-modelling.html"><span class="header-section-number">10</span> Regression Modelling</a></li>
<li><a class="" href="decision-trees-and-random-forests.html"><span class="header-section-number">11</span> Decision Trees and Random Forests</a></li>
<li><a class="" href="neural-networks.html"><span class="header-section-number">12</span> Neural Networks</a></li>
<li><a class="" href="cluster-analysis.html"><span class="header-section-number">13</span> Cluster Analysis</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/RezaMoammadi/Book-Data-Science">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="data-cleaning" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Data Cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"><i class="fas fa-link"></i></a>
</h1>
<p>The quality of input data has a huge impact on the Data Science Methodology.
For data analytics purposes, database values must undergo data cleaning and data transformation.
Basically, we want to minimize <em>garbage in garbage out</em>.<br>
Thus, it is important to prepare and learn more about the data. This requires cleaning so-called <em>messy</em> data, eliminating unnecessary data, and if it’s needed recording the (part of) data for the modeling part.</p>
<p>In general, data cleaning is the most time consuming part of the date science methodology.
Effort for data preparation and cleaning ranges around 10%-60% of data analysis process – depending on the dataset.</p>
<div id="diamonds-dataset-for-data-cleaning" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> <code>diamonds</code> dataset for data cleaning<a class="anchor" aria-label="anchor" href="#diamonds-dataset-for-data-cleaning"><i class="fas fa-link"></i></a>
</h2>
<p>We represent how to preform the steps one and two of the Data Science Methodology using the <code>diamonds</code> dataset. This dataset is available in <a href="https://CRAN.R-project.org/package=ggplot2"><strong>ggplot2</strong></a> package and contains information about ~<span class="math inline">\(54,000\)</span> diamonds, including the <code>price</code>, <code>carat</code>, <code>color</code>, <code>clarity</code>, <code>cut</code>, and dimensions of each diamond.</p>
<p>In general, we could import the Dataset sheet from our personal computer or an online source into <strong>R</strong>, by using the <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> function. But, here, since the <em>diamonds</em> dataset is available in the <strong>R</strong> package “<em>ggplot2</em>”, we import the <em>diamonds</em> dataset in <strong>R</strong> as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">diamonds</span><span class="op">)</span> <span class="co"># loads "diamonds" data in your RStudio environment</span></span></code></pre></div>
<p>To see the overview of the dataset in <strong>R</strong>, we could use the following functions:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> to see a compact display of the structure of the data.</li>
<li>
<code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> to see spreadsheet-style data.</li>
<li>
<code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> to see the first part of the data (first 6-rows of data).</li>
<li>
<code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> to see the summary of each variable.</li>
</ul>
<p>Here we use the <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> function to report the structure of the <em>diamonds</em> dataset as follows</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data-cleaning.html#cb4-1" tabindex="-1"></a><span class="fu">str</span>(diamonds)   </span>
<span id="cb4-2"><a href="data-cleaning.html#cb4-2" tabindex="-1"></a>   tibble [<span class="dv">53</span>,<span class="dv">940</span> × <span class="dv">10</span>] (S3<span class="sc">:</span> tbl_df<span class="sc">/</span>tbl<span class="sc">/</span>data.frame)</span>
<span id="cb4-3"><a href="data-cleaning.html#cb4-3" tabindex="-1"></a>    <span class="sc">$</span> carat  <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">53940</span>] <span class="fl">0.23</span> <span class="fl">0.21</span> <span class="fl">0.23</span> <span class="fl">0.29</span> <span class="fl">0.31</span> <span class="fl">0.24</span> <span class="fl">0.24</span> <span class="fl">0.26</span> <span class="fl">0.22</span> <span class="fl">0.23</span> ...</span>
<span id="cb4-4"><a href="data-cleaning.html#cb4-4" tabindex="-1"></a>    <span class="sc">$</span> cut    <span class="sc">:</span> Ord.factor w<span class="sc">/</span> <span class="dv">5</span> levels <span class="st">"Fair"</span><span class="sc">&lt;</span><span class="st">"Good"</span><span class="sc">&lt;</span>..<span class="sc">:</span> <span class="dv">5</span> <span class="dv">4</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">3</span> ...</span>
<span id="cb4-5"><a href="data-cleaning.html#cb4-5" tabindex="-1"></a>    <span class="sc">$</span> color  <span class="sc">:</span> Ord.factor w<span class="sc">/</span> <span class="dv">7</span> levels <span class="st">"D"</span><span class="sc">&lt;</span><span class="st">"E"</span><span class="sc">&lt;</span><span class="st">"F"</span><span class="sc">&lt;</span><span class="st">"G"</span><span class="sc">&lt;</span>..<span class="sc">:</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">7</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">5</span> ...</span>
<span id="cb4-6"><a href="data-cleaning.html#cb4-6" tabindex="-1"></a>    <span class="sc">$</span> clarity<span class="sc">:</span> Ord.factor w<span class="sc">/</span> <span class="dv">8</span> levels <span class="st">"I1"</span><span class="sc">&lt;</span><span class="st">"SI2"</span><span class="sc">&lt;</span><span class="st">"SI1"</span><span class="sc">&lt;</span>..<span class="sc">:</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">4</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> ...</span>
<span id="cb4-7"><a href="data-cleaning.html#cb4-7" tabindex="-1"></a>    <span class="sc">$</span> depth  <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">53940</span>] <span class="fl">61.5</span> <span class="fl">59.8</span> <span class="fl">56.9</span> <span class="fl">62.4</span> <span class="fl">63.3</span> <span class="fl">62.8</span> <span class="fl">62.3</span> <span class="fl">61.9</span> <span class="fl">65.1</span> <span class="fl">59.4</span> ...</span>
<span id="cb4-8"><a href="data-cleaning.html#cb4-8" tabindex="-1"></a>    <span class="sc">$</span> table  <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">53940</span>] <span class="dv">55</span> <span class="dv">61</span> <span class="dv">65</span> <span class="dv">58</span> <span class="dv">58</span> <span class="dv">57</span> <span class="dv">57</span> <span class="dv">55</span> <span class="dv">61</span> <span class="dv">61</span> ...</span>
<span id="cb4-9"><a href="data-cleaning.html#cb4-9" tabindex="-1"></a>    <span class="sc">$</span> price  <span class="sc">:</span> int [<span class="dv">1</span><span class="sc">:</span><span class="dv">53940</span>] <span class="dv">326</span> <span class="dv">326</span> <span class="dv">327</span> <span class="dv">334</span> <span class="dv">335</span> <span class="dv">336</span> <span class="dv">336</span> <span class="dv">337</span> <span class="dv">337</span> <span class="dv">338</span> ...</span>
<span id="cb4-10"><a href="data-cleaning.html#cb4-10" tabindex="-1"></a>    <span class="sc">$</span> x      <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">53940</span>] <span class="fl">3.95</span> <span class="fl">3.89</span> <span class="fl">4.05</span> <span class="fl">4.2</span> <span class="fl">4.34</span> <span class="fl">3.94</span> <span class="fl">3.95</span> <span class="fl">4.07</span> <span class="fl">3.87</span> <span class="dv">4</span> ...</span>
<span id="cb4-11"><a href="data-cleaning.html#cb4-11" tabindex="-1"></a>    <span class="sc">$</span> y      <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">53940</span>] <span class="fl">3.98</span> <span class="fl">3.84</span> <span class="fl">4.07</span> <span class="fl">4.23</span> <span class="fl">4.35</span> <span class="fl">3.96</span> <span class="fl">3.98</span> <span class="fl">4.11</span> <span class="fl">3.78</span> <span class="fl">4.05</span> ...</span>
<span id="cb4-12"><a href="data-cleaning.html#cb4-12" tabindex="-1"></a>    <span class="sc">$</span> z      <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">53940</span>] <span class="fl">2.43</span> <span class="fl">2.31</span> <span class="fl">2.31</span> <span class="fl">2.63</span> <span class="fl">2.75</span> <span class="fl">2.48</span> <span class="fl">2.47</span> <span class="fl">2.53</span> <span class="fl">2.49</span> <span class="fl">2.39</span> ...</span></code></pre></div>
<p>It shows the dataset has 53940 observations and 10 variables where:</p>
<ul>
<li>
<code>price</code>: price in US dollars ($326–$18,823).</li>
<li>
<code>carat</code>: weight of the diamond (0.2–5.01).</li>
<li>
<code>cut</code>: quality of the cut (Fair, Good, Very Good, Premium, Ideal).</li>
<li>
<code>color</code>: diamond color, from D (best) to J (worst).</li>
<li>
<code>clarity</code>: a measurement of how clear the diamond is (I1 (worst), SI2, SI1, VS2, VS1, VVS2, VVS1, IF (best)).</li>
<li>
<code>x</code>: length in mm (0–10.74).</li>
<li>
<code>y</code>: width in mm (0–58.9).</li>
<li>
<code>z</code>: depth in mm (0–31.8).</li>
<li>
<code>depth</code>: total depth percentage = <code>z</code> / mean(<code>x</code>, <code>y</code>) = 2 * <code>z</code> / (<code>x</code> + <code>y</code>).</li>
</ul>
<p>To see the first part of the data</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data-cleaning.html#cb5-1" tabindex="-1"></a><span class="fu">head</span>(diamonds)   </span>
<span id="cb5-2"><a href="data-cleaning.html#cb5-2" tabindex="-1"></a>   <span class="co"># A tibble: 6 × 10</span></span>
<span id="cb5-3"><a href="data-cleaning.html#cb5-3" tabindex="-1"></a>     carat cut       color clarity depth table price     x     y     z</span>
<span id="cb5-4"><a href="data-cleaning.html#cb5-4" tabindex="-1"></a>     <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>ord<span class="sc">&gt;</span>     <span class="er">&lt;</span>ord<span class="sc">&gt;</span> <span class="er">&lt;</span>ord<span class="sc">&gt;</span>   <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb5-5"><a href="data-cleaning.html#cb5-5" tabindex="-1"></a>   <span class="dv">1</span>  <span class="fl">0.23</span> Ideal     E     SI2      <span class="fl">61.5</span>    <span class="dv">55</span>   <span class="dv">326</span>  <span class="fl">3.95</span>  <span class="fl">3.98</span>  <span class="fl">2.43</span></span>
<span id="cb5-6"><a href="data-cleaning.html#cb5-6" tabindex="-1"></a>   <span class="dv">2</span>  <span class="fl">0.21</span> Premium   E     SI1      <span class="fl">59.8</span>    <span class="dv">61</span>   <span class="dv">326</span>  <span class="fl">3.89</span>  <span class="fl">3.84</span>  <span class="fl">2.31</span></span>
<span id="cb5-7"><a href="data-cleaning.html#cb5-7" tabindex="-1"></a>   <span class="dv">3</span>  <span class="fl">0.23</span> Good      E     VS1      <span class="fl">56.9</span>    <span class="dv">65</span>   <span class="dv">327</span>  <span class="fl">4.05</span>  <span class="fl">4.07</span>  <span class="fl">2.31</span></span>
<span id="cb5-8"><a href="data-cleaning.html#cb5-8" tabindex="-1"></a>   <span class="dv">4</span>  <span class="fl">0.29</span> Premium   I     VS2      <span class="fl">62.4</span>    <span class="dv">58</span>   <span class="dv">334</span>  <span class="fl">4.2</span>   <span class="fl">4.23</span>  <span class="fl">2.63</span></span>
<span id="cb5-9"><a href="data-cleaning.html#cb5-9" tabindex="-1"></a>   <span class="dv">5</span>  <span class="fl">0.31</span> Good      J     SI2      <span class="fl">63.3</span>    <span class="dv">58</span>   <span class="dv">335</span>  <span class="fl">4.34</span>  <span class="fl">4.35</span>  <span class="fl">2.75</span></span>
<span id="cb5-10"><a href="data-cleaning.html#cb5-10" tabindex="-1"></a>   <span class="dv">6</span>  <span class="fl">0.24</span> Very Good J     VVS2     <span class="fl">62.8</span>    <span class="dv">57</span>   <span class="dv">336</span>  <span class="fl">3.94</span>  <span class="fl">3.96</span>  <span class="fl">2.48</span></span></code></pre></div>
<p>After loading dataset in the R, we need to know which type of features (variables, attributes, or fields) we have in our dataset.</p>
<p>In general, the type of variables are:</p>
<ol style="list-style-type: decimal">
<li>Quantitative (or numerical) variables: which are represented by numbers, and are divided into three broad divisions.
<ul>
<li>Continuous variables: which are represented by entities get a distinct score. For example, in the diamonds dataset, the length of diamonds (variable <code>x</code>) as well as variables <code>y</code>, <code>z</code>, and <code>depth</code> are continuous.</li>
<li>Discrete (or count) variables: are countable in a finite amount of time. Some examples of such variables are age (in years) and number of customer who churn the company.</li>
</ul>
</li>
<li>Qualitative (or categorical) variables: which describe data that fits into categories and they are not numerical. They may be divided into three broad divisions.
<ul>
<li>Ordinal variables: are ordered categories and the distances between the categories are not known. For example, cloth sizes S, M, L, and XL. As an another example, in the diamonds dataset variable <code>clarity</code> is ordinal.</li>
<li>Binary variables: are variables which only take two values. For example, having a tattoo (yes/no)</li>
<li>Nominal variables: are categorical variables which do not have intrinsic ordering to the categories. For example, gender (female, male, LGBT) or color of diamonds in the diamonds dataset.</li>
</ul>
</li>
</ol>
</div>
<div id="outliers" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Outliers<a class="anchor" aria-label="anchor" href="#outliers"><i class="fas fa-link"></i></a>
</h2>
<p>Outlines are unusual/extreme values that significantly differ from other observations.
Outliers may be due to variability in the measurement or may be due to data entry errors.
Outliers can potentially have serious problems in statistical analyses.
Thus, it’s important to detect potential outliers in the dataset and deal with them in an appropriate manner.
One easy way to detect outliers is by data visualization methods.</p>
<div id="identify-outliers-by-boxplot" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Identify outliers by boxplot<a class="anchor" aria-label="anchor" href="#identify-outliers-by-boxplot"><i class="fas fa-link"></i></a>
</h3>
<p>We can detect outliers by using Boxplot which represents the distribution of the feature. Boxplot is suitable for the numerical features.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:boxplot"></span>
<img src="images/boxplot.png" alt="Box plot is useful to report the summay for the numerical features/variables in the dataset." width="50%"><p class="caption">
Figure 3.1: Box plot is useful to report the summay for the numerical features/variables in the dataset.
</p>
</div>
<p>For example, the Boxplot for the variable <code>y</code> (width of diamonds) from the <code>diamonds</code> dataset is</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_boxplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="data-cleaning_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></div>
<p>The <code>y</code> variable measures one of the three dimensions of these diamonds, in mm. We know that diamonds can’t have a width of 0mm, so these values must be incorrect. We might also suspect that measurements of 32mm and 59mm are implausible.</p>
</div>
<div id="identify-outliers-by-histogram" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Identify outliers by histogram<a class="anchor" aria-label="anchor" href="#identify-outliers-by-histogram"><i class="fas fa-link"></i></a>
</h3>
<p>Another way to detect outliers is by using histogram which represents the distribution of the feature.
For example, the histogram for the variable <code>y</code> (width of diamonds) from the <code>diamonds</code> dataset is</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">'blue'</span>, </span>
<span>                 fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="data-cleaning_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></div>
<p>There are so many observations in the common bins that the rare bins are so short that you cann’t see them (although maybe if you stare intently at 0 you’ll spot something). To make it easy to see the unusual values, we need to zoom in to small values of the y-axis:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                 color <span class="op">=</span> <span class="st">'blue'</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="data-cleaning_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="identify-outliers-by-scator-plot" class="section level3" number="3.2.3">
<h3>
<span class="header-section-number">3.2.3</span> Identify outliers by scator plot<a class="anchor" aria-label="anchor" href="#identify-outliers-by-scator-plot"><i class="fas fa-link"></i></a>
</h3>
<p>Another way to detect outliers is by using scatter plot which represents the point distribution between two numerical features.
For example, the scatter plot for variable <code>y</code> vs <code>price</code> is</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, y <span class="op">=</span> <span class="va">price</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">'blue'</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="data-cleaning_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></div>
<p>We might also suspect that measurements of 32mm and 59mm are implausible: those diamonds are over an inch long, but don’t cost hundreds of thousands of dollars!</p>
</div>
</div>
<div id="handling-outliers" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Handling Outliers<a class="anchor" aria-label="anchor" href="#handling-outliers"><i class="fas fa-link"></i></a>
</h2>
<p>After detecting outliers, we should decide what to do with them. In this case we have two options:</p>
<ol style="list-style-type: decimal">
<li>Treat outliers as missing values, which we recommend;</li>
<li>Remove outliers from the dataset, which we do <em>not</em> recommend it.</li>
</ol>
<p>For replacing outliers with missing values, one easy way to do it is to use <code>mutate()</code> function which is from the <strong>plyr</strong> package; With this function, we can replace the variable with a modified copy. You can use the <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> function to replace unusual values with <code>NA</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diamonds_2</span> <span class="op">=</span> <span class="fu">mutate</span><span class="op">(</span><span class="va">diamonds</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">y</span> <span class="op">==</span>  <span class="fl">0</span> <span class="op">|</span> <span class="va">y</span> <span class="op">&gt;</span> <span class="fl">30</span>, <span class="cn">NA</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><a href="https://rdrr.io/r/base/ifelse.html"><code>ifelse()</code></a> has three arguments. The first argument test should be a logical vector. The result will contain the value of the second argument, <code>yes</code>, when test is <code>TRUE</code>, and the value of the third argument, <code>no</code>, when it is <code>FALSE</code>.
Note, in R, we show missing values with NA (Not Available).</p>
<p>To see the summary of the variable <code>y</code> with missing values:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data-cleaning.html#cb11-1" tabindex="-1"></a><span class="fu">summary</span>(diamonds_2<span class="sc">$</span>y)</span>
<span id="cb11-2"><a href="data-cleaning.html#cb11-2" tabindex="-1"></a>      Min. <span class="dv">1</span>st Qu.  Median    Mean <span class="dv">3</span>rd Qu.    Max.    NA<span class="st">'s </span></span>
<span id="cb11-3"><a href="data-cleaning.html#cb11-3" tabindex="-1"></a><span class="st">     3.680   4.720   5.710   5.734   6.540  10.540       9</span></span></code></pre></div>
<p>which show that we have 9 unusual values which are replaced by <code>NA</code>.</p>
<p>For the case of removing outliers for the dataset, we can do it by using <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> function from <strong>dplyr</strong> package</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diamonds_2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">diamonds</span>, <span class="fu">between</span><span class="op">(</span><span class="va">y</span>, <span class="fl">3</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds_2</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, y <span class="op">=</span> <span class="va">price</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">'blue'</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="data-cleaning_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></div>
<p>It’s good practice to repeat your analysis with and without the outliers. If they have minimal effect on the results, and you can’t figure out why they’re there, it’s reasonable to replace them with missing values, and move on. However, if they have a substantial effect on your results, you shouldn’t drop them without justification. You’ll need to figure out what caused them (e.g. a data entry error) and disclose that you removed them in your write-up.</p>
</div>
<div id="missing-values" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Missing Values<a class="anchor" aria-label="anchor" href="#missing-values"><i class="fas fa-link"></i></a>
</h2>
<p>Missing values pose problems to data analysis methods. We have two option to deal with the missing values:</p>
<ol style="list-style-type: decimal">
<li>Impute the missing values which we recommend.</li>
<li>Delete Records Containing Missing Values which we do <em>not</em> recommend; this option is similar to the precious section for removing outliers.</li>
</ol>
<p>To impute the missing values with <em>random</em> values (which is proportional to categories’ records) by using the function <code>impute()</code> from R package <strong>Hmisc</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diamonds_2</span><span class="op">$</span><span class="va">y</span> <span class="op">=</span> <span class="fu">impute</span><span class="op">(</span><span class="va">diamonds_2</span><span class="op">$</span><span class="va">y</span>, <span class="st">'random'</span><span class="op">)</span></span></code></pre></div>
<p>To see the summary of the variable <code>y</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data-cleaning.html#cb15-1" tabindex="-1"></a><span class="fu">summary</span>(diamonds_2<span class="sc">$</span>y)</span>
<span id="cb15-2"><a href="data-cleaning.html#cb15-2" tabindex="-1"></a>      Min. <span class="dv">1</span>st Qu.  Median    Mean <span class="dv">3</span>rd Qu.    Max. </span>
<span id="cb15-3"><a href="data-cleaning.html#cb15-3" tabindex="-1"></a>     <span class="fl">3.680</span>   <span class="fl">4.720</span>   <span class="fl">5.710</span>   <span class="fl">5.734</span>   <span class="fl">6.540</span>  <span class="fl">10.540</span></span></code></pre></div>
</div>
<div id="data-transformation" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Data Transformation<a class="anchor" aria-label="anchor" href="#data-transformation"><i class="fas fa-link"></i></a>
</h2>
<p>In Data Science Methodology, before applying any machine learning algorithms, sometimes, we need to convert the raw data into a format or structure that would be more suitable for modeling. Fer example, in “diamonds” dataset, variable <code>carat</code> range between (0.2, 5) and variable <code>price</code> range between (326, 18823). Some some machine learning algorithms (i.e. the k-nearest neighbor algorithm) are adversely affected by differences in variable ranges. Variables with greater ranges tend to have larger influence on the data model’s results. Thus, numeric field values should be normalized.
Two of the prevalent methods will be reviewed</p>
<ul>
<li>min-max transformation.</li>
<li>Z-score transformation also know as an Z-score Standardization</li>
</ul>
</div>
<div id="how-to-reexpress-categorical-field-values" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> How to Reexpress Categorical Field Values<a class="anchor" aria-label="anchor" href="#how-to-reexpress-categorical-field-values"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="intro-DS.html"><span class="header-section-number">2</span> Introduction to Data Science</a></div>
<div class="next"><a href="exploratory-data-analysis-1.html"><span class="header-section-number">4</span> Exploratory Data Analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-cleaning"><span class="header-section-number">3</span> Data Cleaning</a></li>
<li><a class="nav-link" href="#diamonds-dataset-for-data-cleaning"><span class="header-section-number">3.1</span> diamonds dataset for data cleaning</a></li>
<li>
<a class="nav-link" href="#outliers"><span class="header-section-number">3.2</span> Outliers</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#identify-outliers-by-boxplot"><span class="header-section-number">3.2.1</span> Identify outliers by boxplot</a></li>
<li><a class="nav-link" href="#identify-outliers-by-histogram"><span class="header-section-number">3.2.2</span> Identify outliers by histogram</a></li>
<li><a class="nav-link" href="#identify-outliers-by-scator-plot"><span class="header-section-number">3.2.3</span> Identify outliers by scator plot</a></li>
</ul>
</li>
<li><a class="nav-link" href="#handling-outliers"><span class="header-section-number">3.3</span> Handling Outliers</a></li>
<li><a class="nav-link" href="#missing-values"><span class="header-section-number">3.4</span> Missing Values</a></li>
<li><a class="nav-link" href="#data-transformation"><span class="header-section-number">3.5</span> Data Transformation</a></li>
<li><a class="nav-link" href="#how-to-reexpress-categorical-field-values"><span class="header-section-number">3.6</span> How to Reexpress Categorical Field Values</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/RezaMoammadi/Book-Data-Science/blob/master/data-cleaning.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/RezaMoammadi/Book-Data-Science/edit/master/data-cleaning.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Uncovering Data Science with R</strong>" was written by . It was last built on 2024-08-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
