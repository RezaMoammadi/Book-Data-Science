<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 K-Nearest Neighbors | Uncovering Data Science with R</title>
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Chapter 7 K-Nearest Neighbors | Uncovering Data Science with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://uncovering-data-science.netlify.app/chapter:knn.html">
<meta property="og:image" content="https://uncovering-data-science.netlify.app/images/cover.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 K-Nearest Neighbors | Uncovering Data Science with R">
<meta name="twitter:image" content="https://uncovering-data-science.netlify.app/images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="About K-Nearest Neighbors (knn) algorithm … Here, we are going to use the following R packages: liver: the bank and churn datasets are in this package. We also use the partition(), kNN() functions...">
<meta property="og:description" content="About K-Nearest Neighbors (knn) algorithm … Here, we are going to use the following R packages: liver: the bank and churn datasets are in this package. We also use the partition(), kNN() functions...">
<meta name="twitter:description" content="About K-Nearest Neighbors (knn) algorithm … Here, we are going to use the following R packages: liver: the bank and churn datasets are in this package. We also use the partition(), kNN() functions...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Uncovering Data Science with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="chapter-into-R.html"><span class="header-section-number">1</span> The Basics for R</a></li>
<li><a class="" href="chapter:intro-DS.html"><span class="header-section-number">2</span> Introduction to Data Science</a></li>
<li><a class="" href="chapter:data-prep.html"><span class="header-section-number">3</span> Data Preparation</a></li>
<li><a class="" href="chapter:EDA.html"><span class="header-section-number">4</span> Exploratory Data Analysis</a></li>
<li><a class="" href="chapter:statistics.html"><span class="header-section-number">5</span> Statistical Inference and Hypothesis Testing</a></li>
<li><a class="" href="chapter:modeling.html"><span class="header-section-number">6</span> Modeling Process</a></li>
<li><a class="active" href="chapter:knn.html"><span class="header-section-number">7</span> K-Nearest Neighbors</a></li>
<li><a class="" href="chapter:evaluation.html"><span class="header-section-number">8</span> Model Evaluation</a></li>
<li><a class="" href="chapter:bayes.html"><span class="header-section-number">9</span> Naive Bayes Classifier</a></li>
<li><a class="" href="chapter:regression.html"><span class="header-section-number">10</span> Regression Modelling</a></li>
<li><a class="" href="decision-trees-and-random-forests.html"><span class="header-section-number">11</span> Decision Trees and Random Forests</a></li>
<li><a class="" href="neural-networks.html"><span class="header-section-number">12</span> Neural Networks</a></li>
<li><a class="" href="cluster-analysis.html"><span class="header-section-number">13</span> Cluster Analysis</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/RezaMoammadi/Book-Data-Science">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chapter:knn" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> K-Nearest Neighbors<a class="anchor" aria-label="anchor" href="#chapter:knn"><i class="fas fa-link"></i></a>
</h1>
<p>About K-Nearest Neighbors (knn) algorithm …</p>
<p>Here, we are going to use the following R packages:</p>
<ul>
<li>
<strong><a href="https://CRAN.R-project.org/package=liver">liver</a></strong>: the <em>bank</em> and <em>churn</em> datasets are in this package. We also use the <code><a href="https://rdrr.io/pkg/liver/man/partition.html">partition()</a></code>, <code><a href="https://rdrr.io/pkg/liver/man/kNN.html">kNN()</a></code> functions in this package.</li>
<li>
<strong><a href="https://ggplot2.tidyverse.org/index.html">ggplot2</a></strong>: we use this package for visualization.</li>
<li>
<strong><a href="https://CRAN.R-project.org/package=pROC">pROC</a></strong>: to create ROC curve and compute AUC values, we use the <code><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc()</a></code> and <code><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc()</a></code> functions in this package.</li>
</ul>
<p>If it’s needed, install these packages on your computer. Here we load them:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://www.uva.nl/profile/a.mohammadi">liver</a></span>  <span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"liver"</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span>   <span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pROC"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.uva.nl/profile/a.mohammadi">liver</a></span><span class="op">)</span>  </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>   </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span>   </span></code></pre></div>
<div id="classification-for-bank-direct-marketing-dataset" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Classification for Bank direct marketing dataset<a class="anchor" aria-label="anchor" href="#classification-for-bank-direct-marketing-dataset"><i class="fas fa-link"></i></a>
</h2>
<p>We aim to identify customer segments through the analysis of data from customers who have subscribed to a term deposit. This will enable us to determine the characteristics of customers who are more inclined to purchase the product.</p>
<div id="business-understanding-2" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> Business Understanding<a class="anchor" aria-label="anchor" href="#business-understanding-2"><i class="fas fa-link"></i></a>
</h3>
<p>Find the best strategies to improve for the next marketing campaign. How can the financial institution have greater effectiveness for future marketing campaigns? To make a data-driven decision, we need to analyze the last marketing campaign the bank performed and identify the patterns that will help us find conclusions to develop future strategies.</p>
<div id="bank-direct-marketing-info" class="section level4" number="7.1.1.1">
<h4>
<span class="header-section-number">7.1.1.1</span> Bank direct marketing info<a class="anchor" aria-label="anchor" href="#bank-direct-marketing-info"><i class="fas fa-link"></i></a>
</h4>
<p>Two main approaches for enterprises to promote products/services are:</p>
<ul>
<li>
<em>mass campaigns</em>: targeting general indiscriminate public,</li>
<li>
<em>directed marketing</em>, targeting a specific set of contacts.</li>
</ul>
<p>In general, positive responses to mass campaigns are typically very low (less than 1%). On the other hand, direct marketing focuses on targets that are keener to that specific product/service, making this kind of campaign more effective. However, direct marketing has some drawbacks, for instance, it may trigger a negative attitude towards banks due to the intrusion of privacy.</p>
<p>Banks are interested to increase financial assets. One strategy is to offer attractive long-term deposit applications with good interest rates, in particular, by using directed marketing campaigns. Also, the same drivers are pressing for a reduction in costs and time. Thus, there is a need for an improvement in efficiency: lesser contacts should be done, but an approximate number of successes (clients subscribing to the deposit) should be kept.</p>
</div>
<div id="what-is-a-term-deposit" class="section level4" number="7.1.1.2">
<h4>
<span class="header-section-number">7.1.1.2</span> What is a Term Deposit?<a class="anchor" aria-label="anchor" href="#what-is-a-term-deposit"><i class="fas fa-link"></i></a>
</h4>
<p>A Term Deposit is a deposit that a bank or a financial institution offers with a fixed rate (often better than just opening a deposit account), in which your money will be returned at a specific maturity time. For more information with regards to Term Deposits please check <a href="https://www.investopedia.com/terms/t/termdeposit.asp">here</a>.</p>
</div>
</div>
<div id="data-undestanding" class="section level3" number="7.1.2">
<h3>
<span class="header-section-number">7.1.2</span> Data Undestanding<a class="anchor" aria-label="anchor" href="#data-undestanding"><i class="fas fa-link"></i></a>
</h3>
<p>The <em>bank</em> dataset is related to direct marketing campaigns of a Portuguese banking institution. You can find more information related to this dataset at: <a href="https://rdrr.io/cran/liver/man/bank.html">https://rdrr.io/cran/liver/man/bank.html</a></p>
<p>The marketing campaigns were based on phone calls. Often, more than one contact (to the same client) was required, to access if the product (bank term deposit) would be (or not) subscribed. The classification goal is to predict if the client will subscribe to a term deposit (variable deposit).</p>
<p>We import the <em>bank</em> dataset:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span>      </span></code></pre></div>
<p>We can see the structure of the dataset by using the <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> function:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="chapter:knn.html#cb63-1" tabindex="-1"></a><span class="fu">str</span>(bank)</span>
<span id="cb63-2"><a href="chapter:knn.html#cb63-2" tabindex="-1"></a>   <span class="st">'data.frame'</span><span class="sc">:</span>    <span class="dv">4521</span> obs. of  <span class="dv">17</span> variables<span class="sc">:</span></span>
<span id="cb63-3"><a href="chapter:knn.html#cb63-3" tabindex="-1"></a>    <span class="er">$</span> age      <span class="sc">:</span> int  <span class="dv">30</span> <span class="dv">33</span> <span class="dv">35</span> <span class="dv">30</span> <span class="dv">59</span> <span class="dv">35</span> <span class="dv">36</span> <span class="dv">39</span> <span class="dv">41</span> <span class="dv">43</span> ...</span>
<span id="cb63-4"><a href="chapter:knn.html#cb63-4" tabindex="-1"></a>    <span class="sc">$</span> job      <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">12</span> levels <span class="st">"admin."</span>,<span class="st">"blue-collar"</span>,..<span class="sc">:</span> <span class="dv">11</span> <span class="dv">8</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">10</span> <span class="dv">3</span> <span class="dv">8</span> ...</span>
<span id="cb63-5"><a href="chapter:knn.html#cb63-5" tabindex="-1"></a>    <span class="sc">$</span> marital  <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">3</span> levels <span class="st">"divorced"</span>,<span class="st">"married"</span>,..<span class="sc">:</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> ...</span>
<span id="cb63-6"><a href="chapter:knn.html#cb63-6" tabindex="-1"></a>    <span class="sc">$</span> education<span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">4</span> levels <span class="st">"primary"</span>,<span class="st">"secondary"</span>,..<span class="sc">:</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">1</span> ...</span>
<span id="cb63-7"><a href="chapter:knn.html#cb63-7" tabindex="-1"></a>    <span class="sc">$</span> default  <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">2</span> levels <span class="st">"no"</span>,<span class="st">"yes"</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb63-8"><a href="chapter:knn.html#cb63-8" tabindex="-1"></a>    <span class="sc">$</span> balance  <span class="sc">:</span> int  <span class="dv">1787</span> <span class="dv">4789</span> <span class="dv">1350</span> <span class="dv">1476</span> <span class="dv">0</span> <span class="dv">747</span> <span class="dv">307</span> <span class="dv">147</span> <span class="dv">221</span> <span class="sc">-</span><span class="dv">88</span> ...</span>
<span id="cb63-9"><a href="chapter:knn.html#cb63-9" tabindex="-1"></a>    <span class="sc">$</span> housing  <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">2</span> levels <span class="st">"no"</span>,<span class="st">"yes"</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> ...</span>
<span id="cb63-10"><a href="chapter:knn.html#cb63-10" tabindex="-1"></a>    <span class="sc">$</span> loan     <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">2</span> levels <span class="st">"no"</span>,<span class="st">"yes"</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> ...</span>
<span id="cb63-11"><a href="chapter:knn.html#cb63-11" tabindex="-1"></a>    <span class="sc">$</span> contact  <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">3</span> levels <span class="st">"cellular"</span>,<span class="st">"telephone"</span>,..<span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">1</span> ...</span>
<span id="cb63-12"><a href="chapter:knn.html#cb63-12" tabindex="-1"></a>    <span class="sc">$</span> day      <span class="sc">:</span> int  <span class="dv">19</span> <span class="dv">11</span> <span class="dv">16</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">23</span> <span class="dv">14</span> <span class="dv">6</span> <span class="dv">14</span> <span class="dv">17</span> ...</span>
<span id="cb63-13"><a href="chapter:knn.html#cb63-13" tabindex="-1"></a>    <span class="sc">$</span> month    <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">12</span> levels <span class="st">"apr"</span>,<span class="st">"aug"</span>,<span class="st">"dec"</span>,..<span class="sc">:</span> <span class="dv">11</span> <span class="dv">9</span> <span class="dv">1</span> <span class="dv">7</span> <span class="dv">9</span> <span class="dv">4</span> <span class="dv">9</span> <span class="dv">9</span> <span class="dv">9</span> <span class="dv">1</span> ...</span>
<span id="cb63-14"><a href="chapter:knn.html#cb63-14" tabindex="-1"></a>    <span class="sc">$</span> duration <span class="sc">:</span> int  <span class="dv">79</span> <span class="dv">220</span> <span class="dv">185</span> <span class="dv">199</span> <span class="dv">226</span> <span class="dv">141</span> <span class="dv">341</span> <span class="dv">151</span> <span class="dv">57</span> <span class="dv">313</span> ...</span>
<span id="cb63-15"><a href="chapter:knn.html#cb63-15" tabindex="-1"></a>    <span class="sc">$</span> campaign <span class="sc">:</span> int  <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">1</span> ...</span>
<span id="cb63-16"><a href="chapter:knn.html#cb63-16" tabindex="-1"></a>    <span class="sc">$</span> pdays    <span class="sc">:</span> int  <span class="sc">-</span><span class="dv">1</span> <span class="dv">339</span> <span class="dv">330</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">-</span><span class="dv">1</span> <span class="dv">176</span> <span class="dv">330</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">-</span><span class="dv">1</span> <span class="dv">147</span> ...</span>
<span id="cb63-17"><a href="chapter:knn.html#cb63-17" tabindex="-1"></a>    <span class="sc">$</span> previous <span class="sc">:</span> int  <span class="dv">0</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">2</span> ...</span>
<span id="cb63-18"><a href="chapter:knn.html#cb63-18" tabindex="-1"></a>    <span class="sc">$</span> poutcome <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">4</span> levels <span class="st">"failure"</span>,<span class="st">"other"</span>,..<span class="sc">:</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">1</span> ...</span>
<span id="cb63-19"><a href="chapter:knn.html#cb63-19" tabindex="-1"></a>    <span class="sc">$</span> deposit  <span class="sc">:</span> Factor w<span class="sc">/</span> <span class="dv">2</span> levels <span class="st">"no"</span>,<span class="st">"yes"</span><span class="sc">:</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span></code></pre></div>
<p>It shows that the <em>bank</em> dataset as a <code>data.frame</code> has 17 variables and 4521 observations. The dataset has 16 predictors along with the target variable <code>deposit</code> which is a binary variable with 2 levels “yes” and “no”. The variables in this dataset are:</p>
<ul>
<li>
<code>age</code>: numeric.</li>
<li>
<code>job</code>: type of job; categorical: “admin.”, “unknown”, “unemployed”, “management”, “housemaid”, “entrepreneur”, “student”, “blue-collar,”self-employed”, “retired”, “technician”, “services”.</li>
<li>
<code>marital</code>: marital status; categorical: “married”, “divorced”, “single”; note: “divorced” means divorced or widowed.</li>
<li>
<code>education</code>: categorical: “secondary”, “primary”, “tertiary”, “unknown”.</li>
<li>
<code>default</code>: has credit in default?; binary: “yes”,“no”.</li>
<li>
<code>balance</code>: average yearly balance, in euros; numeric.</li>
<li>
<code>housing</code>: has housing loan? binary: “yes”, “no”.</li>
<li>
<code>loan</code>: has personal loan? binary: “yes”, “no”.</li>
</ul>
<p>Related with the last contact of the current campaign:</p>
<ul>
<li>
<code>contact</code>: contact: contact communication type; categorical: “unknown”,“telephone”,“cellular”.</li>
<li>
<code>day</code>: last contact day of the month; numeric.</li>
<li>
<code>month</code>: last contact month of year; categorical: “jan”, “feb”, “mar”, …, “nov”, “dec”.</li>
<li>
<code>duration</code>: last contact duration, in seconds; numeric.</li>
</ul>
<p>Other attributes:</p>
<ul>
<li>
<code>campaign</code>: number of contacts performed during this campaign and for this client; numeric, includes last contact.</li>
<li>
<code>pdays</code>: number of days that passed by after the client was last contacted from a previous campaign; numeric, -1 means client was not previously contacted.</li>
<li>
<code>previous</code>: number of contacts performed before this campaign and for this client; numeric.</li>
<li>
<code>poutcome</code>: outcome of the previous marketing campaign; categorical: “success”, “failure”, “unknown”, “other”.</li>
</ul>
<p>Target variable:</p>
<ul>
<li>
<code>deposit</code>: Indicator of whether the client subscribed a term deposit; binary: “yes” or “no”.</li>
</ul>
<p>Here we report the summary of the dataset:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="chapter:knn.html#cb64-1" tabindex="-1"></a><span class="fu">summary</span>(bank)</span>
<span id="cb64-2"><a href="chapter:knn.html#cb64-2" tabindex="-1"></a>         age                 job          marital         education    default   </span>
<span id="cb64-3"><a href="chapter:knn.html#cb64-3" tabindex="-1"></a>    Min.   <span class="sc">:</span><span class="fl">19.00</span>   management <span class="sc">:</span><span class="dv">969</span>   divorced<span class="sc">:</span> <span class="dv">528</span>   primary  <span class="sc">:</span> <span class="dv">678</span>   no <span class="sc">:</span><span class="dv">4445</span>  </span>
<span id="cb64-4"><a href="chapter:knn.html#cb64-4" tabindex="-1"></a>    <span class="dv">1</span>st Qu.<span class="sc">:</span><span class="fl">33.00</span>   blue<span class="sc">-</span>collar<span class="sc">:</span><span class="dv">946</span>   married <span class="sc">:</span><span class="dv">2797</span>   secondary<span class="sc">:</span><span class="dv">2306</span>   yes<span class="sc">:</span>  <span class="dv">76</span>  </span>
<span id="cb64-5"><a href="chapter:knn.html#cb64-5" tabindex="-1"></a>    Median <span class="sc">:</span><span class="fl">39.00</span>   technician <span class="sc">:</span><span class="dv">768</span>   single  <span class="sc">:</span><span class="dv">1196</span>   tertiary <span class="sc">:</span><span class="dv">1350</span>             </span>
<span id="cb64-6"><a href="chapter:knn.html#cb64-6" tabindex="-1"></a>    Mean   <span class="sc">:</span><span class="fl">41.17</span>   admin.     <span class="sc">:</span><span class="dv">478</span>                   unknown  <span class="sc">:</span> <span class="dv">187</span>             </span>
<span id="cb64-7"><a href="chapter:knn.html#cb64-7" tabindex="-1"></a>    <span class="dv">3</span>rd Qu.<span class="sc">:</span><span class="fl">49.00</span>   services   <span class="sc">:</span><span class="dv">417</span>                                              </span>
<span id="cb64-8"><a href="chapter:knn.html#cb64-8" tabindex="-1"></a>    Max.   <span class="sc">:</span><span class="fl">87.00</span>   retired    <span class="sc">:</span><span class="dv">230</span>                                              </span>
<span id="cb64-9"><a href="chapter:knn.html#cb64-9" tabindex="-1"></a>                    (Other)    <span class="sc">:</span><span class="dv">713</span>                                              </span>
<span id="cb64-10"><a href="chapter:knn.html#cb64-10" tabindex="-1"></a>       balance      housing     loan           contact          day       </span>
<span id="cb64-11"><a href="chapter:knn.html#cb64-11" tabindex="-1"></a>    Min.   <span class="sc">:-</span><span class="dv">3313</span>   no <span class="sc">:</span><span class="dv">1962</span>   no <span class="sc">:</span><span class="dv">3830</span>   cellular <span class="sc">:</span><span class="dv">2896</span>   Min.   <span class="sc">:</span> <span class="fl">1.00</span>  </span>
<span id="cb64-12"><a href="chapter:knn.html#cb64-12" tabindex="-1"></a>    <span class="dv">1</span>st Qu.<span class="sc">:</span>   <span class="dv">69</span>   yes<span class="sc">:</span><span class="dv">2559</span>   yes<span class="sc">:</span> <span class="dv">691</span>   telephone<span class="sc">:</span> <span class="dv">301</span>   <span class="dv">1</span>st Qu.<span class="sc">:</span> <span class="fl">9.00</span>  </span>
<span id="cb64-13"><a href="chapter:knn.html#cb64-13" tabindex="-1"></a>    Median <span class="sc">:</span>  <span class="dv">444</span>                         unknown  <span class="sc">:</span><span class="dv">1324</span>   Median <span class="sc">:</span><span class="fl">16.00</span>  </span>
<span id="cb64-14"><a href="chapter:knn.html#cb64-14" tabindex="-1"></a>    Mean   <span class="sc">:</span> <span class="dv">1423</span>                                          Mean   <span class="sc">:</span><span class="fl">15.92</span>  </span>
<span id="cb64-15"><a href="chapter:knn.html#cb64-15" tabindex="-1"></a>    <span class="dv">3</span>rd Qu.<span class="sc">:</span> <span class="dv">1480</span>                                          <span class="dv">3</span>rd Qu.<span class="sc">:</span><span class="fl">21.00</span>  </span>
<span id="cb64-16"><a href="chapter:knn.html#cb64-16" tabindex="-1"></a>    Max.   <span class="sc">:</span><span class="dv">71188</span>                                          Max.   <span class="sc">:</span><span class="fl">31.00</span>  </span>
<span id="cb64-17"><a href="chapter:knn.html#cb64-17" tabindex="-1"></a>                                                                          </span>
<span id="cb64-18"><a href="chapter:knn.html#cb64-18" tabindex="-1"></a>        month         duration       campaign          pdays       </span>
<span id="cb64-19"><a href="chapter:knn.html#cb64-19" tabindex="-1"></a>    may    <span class="sc">:</span><span class="dv">1398</span>   Min.   <span class="sc">:</span>   <span class="dv">4</span>   Min.   <span class="sc">:</span> <span class="fl">1.000</span>   Min.   <span class="sc">:</span> <span class="sc">-</span><span class="fl">1.00</span>  </span>
<span id="cb64-20"><a href="chapter:knn.html#cb64-20" tabindex="-1"></a>    jul    <span class="sc">:</span> <span class="dv">706</span>   <span class="dv">1</span>st Qu.<span class="sc">:</span> <span class="dv">104</span>   <span class="dv">1</span>st Qu.<span class="sc">:</span> <span class="fl">1.000</span>   <span class="dv">1</span>st Qu.<span class="sc">:</span> <span class="sc">-</span><span class="fl">1.00</span>  </span>
<span id="cb64-21"><a href="chapter:knn.html#cb64-21" tabindex="-1"></a>    aug    <span class="sc">:</span> <span class="dv">633</span>   Median <span class="sc">:</span> <span class="dv">185</span>   Median <span class="sc">:</span> <span class="fl">2.000</span>   Median <span class="sc">:</span> <span class="sc">-</span><span class="fl">1.00</span>  </span>
<span id="cb64-22"><a href="chapter:knn.html#cb64-22" tabindex="-1"></a>    jun    <span class="sc">:</span> <span class="dv">531</span>   Mean   <span class="sc">:</span> <span class="dv">264</span>   Mean   <span class="sc">:</span> <span class="fl">2.794</span>   Mean   <span class="sc">:</span> <span class="fl">39.77</span>  </span>
<span id="cb64-23"><a href="chapter:knn.html#cb64-23" tabindex="-1"></a>    nov    <span class="sc">:</span> <span class="dv">389</span>   <span class="dv">3</span>rd Qu.<span class="sc">:</span> <span class="dv">329</span>   <span class="dv">3</span>rd Qu.<span class="sc">:</span> <span class="fl">3.000</span>   <span class="dv">3</span>rd Qu.<span class="sc">:</span> <span class="sc">-</span><span class="fl">1.00</span>  </span>
<span id="cb64-24"><a href="chapter:knn.html#cb64-24" tabindex="-1"></a>    apr    <span class="sc">:</span> <span class="dv">293</span>   Max.   <span class="sc">:</span><span class="dv">3025</span>   Max.   <span class="sc">:</span><span class="fl">50.000</span>   Max.   <span class="sc">:</span><span class="fl">871.00</span>  </span>
<span id="cb64-25"><a href="chapter:knn.html#cb64-25" tabindex="-1"></a>    (Other)<span class="sc">:</span> <span class="dv">571</span>                                                   </span>
<span id="cb64-26"><a href="chapter:knn.html#cb64-26" tabindex="-1"></a>       previous          poutcome    deposit   </span>
<span id="cb64-27"><a href="chapter:knn.html#cb64-27" tabindex="-1"></a>    Min.   <span class="sc">:</span> <span class="fl">0.0000</span>   failure<span class="sc">:</span> <span class="dv">490</span>   no <span class="sc">:</span><span class="dv">4000</span>  </span>
<span id="cb64-28"><a href="chapter:knn.html#cb64-28" tabindex="-1"></a>    <span class="dv">1</span>st Qu.<span class="sc">:</span> <span class="fl">0.0000</span>   other  <span class="sc">:</span> <span class="dv">197</span>   yes<span class="sc">:</span> <span class="dv">521</span>  </span>
<span id="cb64-29"><a href="chapter:knn.html#cb64-29" tabindex="-1"></a>    Median <span class="sc">:</span> <span class="fl">0.0000</span>   success<span class="sc">:</span> <span class="dv">129</span>             </span>
<span id="cb64-30"><a href="chapter:knn.html#cb64-30" tabindex="-1"></a>    Mean   <span class="sc">:</span> <span class="fl">0.5426</span>   unknown<span class="sc">:</span><span class="dv">3705</span>             </span>
<span id="cb64-31"><a href="chapter:knn.html#cb64-31" tabindex="-1"></a>    <span class="dv">3</span>rd Qu.<span class="sc">:</span> <span class="fl">0.0000</span>                            </span>
<span id="cb64-32"><a href="chapter:knn.html#cb64-32" tabindex="-1"></a>    Max.   <span class="sc">:</span><span class="fl">25.0000</span>                            </span>
<span id="cb64-33"><a href="chapter:knn.html#cb64-33" tabindex="-1"></a>   </span></code></pre></div>
</div>
<div id="data-preparation-2" class="section level3" number="7.1.3">
<h3>
<span class="header-section-number">7.1.3</span> Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation-2"><i class="fas fa-link"></i></a>
</h3>
<p>We partition the <em>bank</em> dataset randomly into two groups: train set (80%) and test set (20%). Here, we use the <code><a href="https://rdrr.io/pkg/liver/man/partition.html">partition()</a></code> function from the <em>liver</em> package:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_sets</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/liver/man/partition.html">partition</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bank</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train_set</span> <span class="op">=</span> <span class="va">data_sets</span><span class="op">$</span><span class="va">part1</span></span>
<span><span class="va">test_set</span>  <span class="op">=</span> <span class="va">data_sets</span><span class="op">$</span><span class="va">part2</span></span>
<span></span>
<span><span class="va">actual_test</span>  <span class="op">=</span> <span class="va">test_set</span><span class="op">$</span><span class="va">deposit</span></span></code></pre></div>
<p>Note that here we are using the <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code> function to create reproducible results.</p>
<p>We want to validate the partition by testing whether the proportion of the target variable <code>deposit</code> differs between the two data sets. We use a Two-Sample Z-Test for the difference in proportions. To run the test, we use the <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> function in <strong>R</strong>:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="chapter:knn.html#cb66-1" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">sum</span>(train_set<span class="sc">$</span>deposit <span class="sc">==</span> <span class="st">"yes"</span>)</span>
<span id="cb66-2"><a href="chapter:knn.html#cb66-2" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">sum</span>(test_set <span class="sc">$</span>deposit <span class="sc">==</span> <span class="st">"yes"</span>)</span>
<span id="cb66-3"><a href="chapter:knn.html#cb66-3" tabindex="-1"></a></span>
<span id="cb66-4"><a href="chapter:knn.html#cb66-4" tabindex="-1"></a>n1 <span class="ot">=</span> <span class="fu">nrow</span>(train_set)</span>
<span id="cb66-5"><a href="chapter:knn.html#cb66-5" tabindex="-1"></a>n2 <span class="ot">=</span> <span class="fu">nrow</span>(test_set)</span>
<span id="cb66-6"><a href="chapter:knn.html#cb66-6" tabindex="-1"></a></span>
<span id="cb66-7"><a href="chapter:knn.html#cb66-7" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">c</span>(x1, x2), <span class="at">n =</span> <span class="fu">c</span>(n1, n2))</span>
<span id="cb66-8"><a href="chapter:knn.html#cb66-8" tabindex="-1"></a>   </span>
<span id="cb66-9"><a href="chapter:knn.html#cb66-9" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">-</span>sample test <span class="cf">for</span> equality of proportions with continuity correction</span>
<span id="cb66-10"><a href="chapter:knn.html#cb66-10" tabindex="-1"></a>   </span>
<span id="cb66-11"><a href="chapter:knn.html#cb66-11" tabindex="-1"></a>   data<span class="sc">:</span>  <span class="fu">c</span>(x1, x2) out of <span class="fu">c</span>(n1, n2)</span>
<span id="cb66-12"><a href="chapter:knn.html#cb66-12" tabindex="-1"></a>   X<span class="sc">-</span>squared <span class="ot">=</span> <span class="fl">2.3955</span>, df <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.1217</span></span>
<span id="cb66-13"><a href="chapter:knn.html#cb66-13" tabindex="-1"></a>   alternative hypothesis<span class="sc">:</span> two.sided</span>
<span id="cb66-14"><a href="chapter:knn.html#cb66-14" tabindex="-1"></a>   <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb66-15"><a href="chapter:knn.html#cb66-15" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.003830717</span>  <span class="fl">0.041306729</span></span>
<span id="cb66-16"><a href="chapter:knn.html#cb66-16" tabindex="-1"></a>   sample estimates<span class="sc">:</span></span>
<span id="cb66-17"><a href="chapter:knn.html#cb66-17" tabindex="-1"></a>      prop <span class="dv">1</span>    prop <span class="dv">2</span> </span>
<span id="cb66-18"><a href="chapter:knn.html#cb66-18" tabindex="-1"></a>   <span class="fl">0.1191608</span> <span class="fl">0.1004228</span></span></code></pre></div>
<p>Based on the output, answer the following questions:</p>
<ol style="list-style-type: lower-alpha">
<li><p><strong>Why is the above hypothesis test suitable for the above research question? Provide your reasons.</strong></p></li>
<li><p><strong>Specify the null and alternative hypotheses?</strong></p></li>
<li><p><strong>Explain that you reject or do not reject the null hypothesis, at <span class="math inline">\(\alpha=0.05\)</span>. What would be your statistical conclusion?</strong></p></li>
<li><p><strong>What would be a non-statistical interpretation of your findings in c?</strong></p></li>
</ol>
<p><span style="color:blue"><strong>Solution:</strong></span></p>
<ol style="list-style-type: lower-alpha">
<li><p>A Two-sample z-test is suitable here, mainly because we want to compare the proportion of the customers who paid for the <em>deposit</em> between the two groups (“training set” and “test set”).</p></li>
<li><p>The hypotheses are as follows
<span class="math display">\[
\bigg\{
\begin{matrix}
      H_0:  \pi_{deposit,\ train}   =  \pi_{deposit,\ test} \\
      H_a:  \pi_{deposit,\ train} \neq \pi_{deposit,\ test}
\end{matrix}
\]</span></p></li>
<li><p>We don’t reject the <span class="math inline">\(H_0\)</span>, since the <em>p</em>-value is higher than <span class="math inline">\(\alpha=0.05\)</span>. Thus, the difference in the proportion of the costumers who paid for the <em>deposit</em> is not statistically significant between the two groups (“training set” and “test set”).</p></li>
<li><p>Since we did not reject the null hypothesis, we infer that the proportions of people that subscribed to the term deposit in the training and test partitions are not different. This suggests that the partitioning based on the target variable <code>deposit</code> is valid.</p></li>
</ol>
</div>
<div id="classification-using-the-knn-algorithm" class="section level3" number="7.1.4">
<h3>
<span class="header-section-number">7.1.4</span> Classification using the kNN algorithm<a class="anchor" aria-label="anchor" href="#classification-using-the-knn-algorithm"><i class="fas fa-link"></i></a>
</h3>
<p>The results from the “Exploratory Data Analysis (EDA)” (from last week) indicate that the following predictors from 16 predictors in the <em>bank</em> dataset are important to predict <code>deposit</code>.</p>
<p><code>age</code>, <code>default</code>, <code>balance</code>, <code>housing</code>, <code>loan</code>, <code>duration</code>, <code>campaign</code>, <code>pdays</code>, and <code>previous</code>.</p>
<p>Thus, here, based on the training dataset, we want to apply kNN algorithm, by using above predictors in our model. We use the following formula:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula</span> <span class="op">=</span> <span class="va">deposit</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">default</span> <span class="op">+</span> <span class="va">balance</span> <span class="op">+</span> <span class="va">housing</span> <span class="op">+</span> <span class="va">loan</span> <span class="op">+</span> <span class="va">duration</span> <span class="op">+</span> <span class="va">campaign</span> <span class="op">+</span> <span class="va">pdays</span> <span class="op">+</span> <span class="va">previous</span></span></code></pre></div>
<p><strong>NOTE:</strong> The above formula means <code>deposit</code> is the target variable and the rest of the variables in the right side of tilde (“<code>~</code>”) are independent variables.</p>
<p>Based on the training dataset, we want to find the k-nearest neighbor for the test data set. Here we use two different values for k (k = 3 and k = 10). We use the <code><a href="https://rdrr.io/pkg/liver/man/kNN.html">kNN()</a></code> function from the <em>R</em> package <strong>liver</strong>:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predict_knn_3</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/liver/man/kNN.html">kNN</a></span><span class="op">(</span><span class="va">formula</span>, train <span class="op">=</span> <span class="va">train_set</span>, test <span class="op">=</span> <span class="va">test_set</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predict_knn_10</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/liver/man/kNN.html">kNN</a></span><span class="op">(</span><span class="va">formula</span>, train <span class="op">=</span> <span class="va">train_set</span>, test <span class="op">=</span> <span class="va">test_set</span>, k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>To have an overview of the prediction result, we report <em>Confusion Matrix</em> for two different values of k by using the <code>conf.mat</code> function:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="chapter:knn.html#cb69-1" tabindex="-1"></a>(<span class="at">conf_knn_3 =</span> <span class="fu">conf.mat</span>(predict_knn_3, actual_test))</span>
<span id="cb69-2"><a href="chapter:knn.html#cb69-2" tabindex="-1"></a>          Actual</span>
<span id="cb69-3"><a href="chapter:knn.html#cb69-3" tabindex="-1"></a>   Predict  no yes</span>
<span id="cb69-4"><a href="chapter:knn.html#cb69-4" tabindex="-1"></a>       no  <span class="dv">806</span>  <span class="dv">76</span></span>
<span id="cb69-5"><a href="chapter:knn.html#cb69-5" tabindex="-1"></a>       yes  <span class="dv">45</span>  <span class="dv">19</span></span>
<span id="cb69-6"><a href="chapter:knn.html#cb69-6" tabindex="-1"></a></span>
<span id="cb69-7"><a href="chapter:knn.html#cb69-7" tabindex="-1"></a>(<span class="at">conf_knn_10 =</span> <span class="fu">conf.mat</span>(predict_knn_10, actual_test))</span>
<span id="cb69-8"><a href="chapter:knn.html#cb69-8" tabindex="-1"></a>          Actual</span>
<span id="cb69-9"><a href="chapter:knn.html#cb69-9" tabindex="-1"></a>   Predict  no yes</span>
<span id="cb69-10"><a href="chapter:knn.html#cb69-10" tabindex="-1"></a>       no  <span class="dv">834</span>  <span class="dv">74</span></span>
<span id="cb69-11"><a href="chapter:knn.html#cb69-11" tabindex="-1"></a>       yes  <span class="dv">17</span>  <span class="dv">21</span></span></code></pre></div>
<p>We also could report <em>Confusion Matrix</em> by using the <code><a href="https://rdrr.io/pkg/liver/man/conf.mat.plot.html">conf.mat.plot()</a></code> command:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/liver/man/conf.mat.plot.html">conf.mat.plot</a></span><span class="op">(</span><span class="va">predict_knn_3</span>, <span class="va">actual_test</span>, main <span class="op">=</span> <span class="st">"kNN with k = 3"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/liver/man/conf.mat.plot.html">conf.mat.plot</a></span><span class="op">(</span><span class="va">predict_knn_10</span>, <span class="va">actual_test</span>, main <span class="op">=</span> <span class="st">"kNN with k = 10"</span><span class="op">)</span></span></code></pre></div>
<p><img src="knn_files/figure-html/unnamed-chunk-10-1.png" width="50%"><img src="knn_files/figure-html/unnamed-chunk-10-2.png" width="50%"></p>
<p><strong>What do these values mean? Explain what conclusion you will draw.</strong></p>
<p><span style="color:blue"><strong>Solution:</strong></span> <br>
A confusion matrix is a table that is often used to describe the performance of a classification model (or classifier) on a set of test data for which the true values are known. The values of the <em>Confusion Matrix</em> are the “true positive”(TP), “false positive”(FP), “true negative”(TN), and “false negative”(FN) predictions.</p>
<p>At the 2 different k-nearest neighbors these number of the four different predictions outcomes differ. When k=3, then there are less true values then when k=10. So when more neighbors are chosen, more true values are found. Regarding to the above confusion matrices:</p>
<ul>
<li><p>for the case <em>k</em>=3, we have “806 + 19” correct predictions and “76 + 45” wrong predictions.</p></li>
<li><p>for the case k=10, we have “834 + 21” correct predictions and “74 + 17” wrong predictions.</p></li>
</ul>
<p>The comparison of the confusion matrices for the <em>k</em> = 3 and <em>k</em> = 10 indicates that the the kNN algorithm has more accuracy for the case <em>k</em> = 10.</p>
</div>
<div id="knn-algorithm-with-data-transformation" class="section level3" number="7.1.5">
<h3>
<span class="header-section-number">7.1.5</span> kNN algorithm with data transformation<a class="anchor" aria-label="anchor" href="#knn-algorithm-with-data-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>The predictors that we used in the previous question, do not have the same scale. For example, variable <code>duration</code> change between 4 and 3025, whereas the variable <code>loan</code> is binary. In this case, the values of variable <code>duration</code> will overwhelm the contribution of the variable <code>loan</code>. To avoid this situation we use normalization. So, we use min-max normalization and transfer the predictors.</p>
<p>Now, we find the k-nearest neighbor for the test set, based on the training dataset, for the k = 10:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predict_knn_10_trans</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/liver/man/kNN.html">kNN</a></span><span class="op">(</span><span class="va">formula</span>, train <span class="op">=</span> <span class="va">train_set</span>, test <span class="op">=</span> <span class="va">test_set</span>, transform <span class="op">=</span> <span class="st">"minmax"</span>, k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/liver/man/conf.mat.plot.html">conf.mat.plot</a></span><span class="op">(</span><span class="va">predict_knn_10_trans</span>, <span class="va">actual_test</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="knn_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="optimal-value-of-k-for-the-knn-algorithm" class="section level3" number="7.1.6">
<h3>
<span class="header-section-number">7.1.6</span> Optimal value of k for the kNN algorithm<a class="anchor" aria-label="anchor" href="#optimal-value-of-k-for-the-knn-algorithm"><i class="fas fa-link"></i></a>
</h3>
<p>In the previous questions, for finding the k-nearest neighbor for the test set, we set k = 10. But why 10? Here, we want to find out the optimal value of k based on our dataset.</p>
<p>To find out the optimal value of <code>k</code> based on <em>Error Rate</em>, for the different values of k from 1 to 30, we run the k-nearest neighbor for the test set and compute the <em>Error Rate</em> for these models, by running <code><a href="https://rdrr.io/pkg/liver/man/kNN.plot.html">kNN.plot()</a></code> command</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/liver/man/kNN.plot.html">kNN.plot</a></span><span class="op">(</span><span class="va">formula</span>, train <span class="op">=</span> <span class="va">train_set</span>, test <span class="op">=</span> <span class="va">test_set</span>, transform <span class="op">=</span> <span class="st">"minmax"</span>, </span>
<span>          k.max <span class="op">=</span> <span class="fl">30</span>, set.seed <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="knn_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></div>
<p>The plot shows that the minimum value of MSE is for the case that k is 8. Since the smaller values of MSE indicates better predictions, in this case, the optimal value of k would be 8.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="chapter:modeling.html"><span class="header-section-number">6</span> Modeling Process</a></div>
<div class="next"><a href="chapter:evaluation.html"><span class="header-section-number">8</span> Model Evaluation</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chapter:knn"><span class="header-section-number">7</span> K-Nearest Neighbors</a></li>
<li>
<a class="nav-link" href="#classification-for-bank-direct-marketing-dataset"><span class="header-section-number">7.1</span> Classification for Bank direct marketing dataset</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#business-understanding-2"><span class="header-section-number">7.1.1</span> Business Understanding</a></li>
<li><a class="nav-link" href="#data-undestanding"><span class="header-section-number">7.1.2</span> Data Undestanding</a></li>
<li><a class="nav-link" href="#data-preparation-2"><span class="header-section-number">7.1.3</span> Data Preparation</a></li>
<li><a class="nav-link" href="#classification-using-the-knn-algorithm"><span class="header-section-number">7.1.4</span> Classification using the kNN algorithm</a></li>
<li><a class="nav-link" href="#knn-algorithm-with-data-transformation"><span class="header-section-number">7.1.5</span> kNN algorithm with data transformation</a></li>
<li><a class="nav-link" href="#optimal-value-of-k-for-the-knn-algorithm"><span class="header-section-number">7.1.6</span> Optimal value of k for the kNN algorithm</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/RezaMoammadi/Book-Data-Science/blob/master/knn.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/RezaMoammadi/Book-Data-Science/edit/master/knn.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Uncovering Data Science with R</strong>" was written by . It was last built on 2024-08-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
